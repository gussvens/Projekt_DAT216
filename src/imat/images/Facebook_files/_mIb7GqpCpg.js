/*!CK:3403094148!*//*1457500060,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["yiS7Q"]); }

__d('SpotlightViewerThumbnailMixin',['PhotoStore','Vector'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={_getInitialPhotoData:function(){var i=c('PhotoStore').getIndexForID(this.props.setid,this.props.photoid),j=c('PhotoStore').getByIndexImmediate(this.props.setid,i);return j?j:this._getThumbnailPhotoData();},_getThumbnailPhotoData:function(){if(!this.props.dimensions||!this.props.thumbsrc)return null;var i={id:this.props.photoid};for(var j=0;j<this.props.dimensions.length;++j){var k=c('Vector').deserialize(this.props.dimensions[j]);i['image'+j]={width:k.x,height:k.y,uri:this.props.thumbsrc};}return i;}};f.exports=h;},null);
__d('SpotlightSnowflakePhotoViewer',['ArbiterMixin','React','SpotlightViewer','SpotlightViewerAutoResize','SpotlightViewerBehaviorsMixin','SpotlightViewerClose','SpotlightViewerCoreMixin','SpotlightViewerDimensionMixin','SpotlightViewerPagers','SpotlightViewerPageWithKeys','SpotlightViewerThumbnailMixin','SpotlightViewport','SubscriptionsHandler'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('React').createClass({displayName:'SpotlightSnowflakePhotoViewer',mixins:[c('ArbiterMixin'),c('SpotlightViewerBehaviorsMixin'),c('SpotlightViewerCoreMixin'),c('SpotlightViewerThumbnailMixin'),c('SpotlightViewerDimensionMixin')],behaviors:[c('SpotlightViewerPageWithKeys'),c('SpotlightViewerAutoResize')],getViewerID:function(){return 'photoviewer';},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();this._subscriptions=null;},getInitialState:function(){this._subscriptions=new (c('SubscriptionsHandler'))();return {photoData:this._getInitialPhotoData(),open:true};},_enableSubscriptions:function(){this.props.useloadingindicator&&this._subscriptions.addSubscriptions(this.viewState.subscribe('photo_fetch',this.setState.bind(this,{photoData:null},null)));},render:function(){var i=this.getMedia(),j=this.getStageDimensions(),k=this.props.useloadingindicator&&!this.state.photoData;return (c('React').createElement(c('SpotlightViewer'),{open:this.state.open,onHide:this.close},c('React').createElement(c('SpotlightViewport'),{media:i,showLoadingIndicator:k,stageDimensions:j,onClick:this._onClickViewport},c('React').createElement(c('SpotlightViewerClose'),{onClick:this.close}),this.props.disablepaging?null:c('React').createElement(c('SpotlightViewerPagers'),null))));}});f.exports=h;},null);
__d('CampfireImageViewer',['DOM','Event','React','ReactDOM','SpotlightSnowflakePhotoViewer','ge'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={registerPopup:function(i,j){c('Event').listen(i,'click',function(k){h.bootstrap({src:j.src,fbid:j.id,dimensions:[j.width,j.height].join(','),disablePaging:true});});},bootstrap:function(i){var j=c('React').createElement(c('SpotlightSnowflakePhotoViewer'),{dimensions:[i.dimensions],open:true,disablepaging:true,photoid:i.fbid,reverse:false,rootClassName:i.rootClassName,thumbsrc:i.src});h.render(j);},render:function(i){var j=c('ge')('campfire_viewer');if(!j){j=c('DOM').create('div',{id:'messages_viewer'});document.body.appendChild(j);}i=c('ReactDOM').render(i,j);i.subscribeOnce('close',function(){c('ReactDOM').unmountComponentAtNode(j);});}};f.exports=h;},null);