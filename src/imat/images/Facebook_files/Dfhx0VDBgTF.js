/*!CK:3137542135!*//*1457521360,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["oOyW0"]); }

__d('UFIReactionsDialogLayerImpl.react',['cx','BrowserSupport','CSS','DataStore','DOM','Layer','Parent','React','ReactDOM','ReactMount','ReactTransitionEvents','RTLKeys','Style','SubscriptionsHandler','TabbableElements','Vector','ViewportBounds','ge','getElementPosition','getOverlayZIndex','memoize','requestAnimationFrame'],function a(b,c,d,e,f,g,h){var i,j,k,l;if(c.__markCompiled)c.__markCompiled();var m=c('React').PropTypes,n="_1oxh",o="_2r6k",p="_2r6j",q=c('BrowserSupport').hasCSSAnimations(),r="_10ir",s={};i=babelHelpers.inherits(t,c('Layer'));j=i&&i.prototype;t.prototype.updatePosition=function(){'use strict';var v=this.getInsertParent(),w=this.getCausalElement(),x=c('Vector').getElementPosition(w).sub(c('Vector').getElementPosition(v));s.left=x.x+'px';s.top=x.y+'px';s.zIndex=c('getOverlayZIndex')(w,v);c('Style').apply(this.getRoot(),s);return true;};t.prototype.getContentRoot=function(){'use strict';return this.contentRoot;};t.prototype._buildWrapper=function(v,w){'use strict';c('CSS').addClass(w,"_2pu4");this.contentRoot=w;var x=document.createElement('div');c('CSS').addClass(x,"_1oxj");x.appendChild(w);return x;};function t(){'use strict';i.apply(this,arguments);}k=babelHelpers.inherits(u,c('React').Component);l=k&&k.prototype;function u(v,w){'use strict';l.constructor.call(this,v,w);this.getGlobalContainer=c('memoize')(function(){return c('ge')('globalContainer');});this.onKeyDown=this.onKeyDown.bind(this);this.onParentLayerHide=this.finishHide.bind(this);this.onTransitionHide=this.onTransitionHide.bind(this);this.onTransitionShow=this.onTransitionShow.bind(this);}u.prototype.componentDidMount=function(){'use strict';var v=c('ReactDOM').findDOMNode(this.refs.root);this.layer=new t({causalElement:v,insertParent:v},document.createElement('div'));c('DOM').appendContent(v,this.layer.getRoot());this.handler=new (c('SubscriptionsHandler'))();if(this.props.onLayerBlur)this.handler.addSubscriptions(this.layer.subscribe('blur',this.props.onLayerBlur));this.handler.addSubscriptions(this.layer.subscribe('beforeshow',this.beforeShow.bind(this)),this.layer.subscribe('aftershow',this.afterShow.bind(this)),this.layer.subscribe('starthide',this.startHide.bind(this)));this.renderLayer();};u.prototype.componentDidUpdate=function(v){'use strict';this.renderLayer();};u.prototype.componentWillUnmount=function(){'use strict';if(this.layer){var v=this.layer.getContentRoot();c('ReactDOM').unmountComponentAtNode(this.layer.getContentRoot());c('ReactTransitionEvents').removeEndEventListener(v,this.onTransitionHide);c('ReactTransitionEvents').removeEndEventListener(v,this.onTransitionShow);this.handler.release();this.handler=null;this.layer.destroy();this.layer=null;}};u.prototype.isInDocument=function(){'use strict';var v=c('ReactDOM').findDOMNode(this.refs.root);return v&&document.body.contains(v);};u.prototype.afterShow=function(){'use strict';var v=c('TabbableElements').find(this.layer.getContentRoot())[0];v&&v.focus();};u.prototype.beforeShow=function(){'use strict';var v=this.getContextualLayerParent();if(v!==this.layer.getInsertParent()){this.layer.setInsertParent(v);this.setParentLayerSubscription(v);}var w=this.layer.getContentRoot();c('CSS').removeClass(w,'accessible_elem');c('requestAnimationFrame')(function(){var x=c('getElementPosition')(w).y,y=c('ViewportBounds').getTop();c('CSS').conditionClass(w,n,x<y);if(q){c('ReactTransitionEvents').addEndEventListener(w,this.onTransitionShow);c('CSS').addClass(w,r);c('CSS').addClass(w,p);}}.bind(this));};u.prototype.setParentLayerSubscription=function(v){'use strict';if(v!==this.getGlobalContainer()){this.parentLayerSubscription&&this.parentLayerSubscription.unsubscribe();this.parentLayer=null;return;}var w=v,x=null;while(w!==null){x=c('DataStore').get(w,'layer');if(x)break;w=w.parentNode;}if(x&&x!==this.parentLayer){this.parentLayerSubscription&&this.parentLayerSubscription.unsubscribe();this.parentLayerSubscription=x.subscribe('hide',this.onParentLayerHide);this.parentLayer=x;}};u.prototype.startHide=function(){'use strict';if(q){var v=this.layer.getContentRoot();c('ReactTransitionEvents').addEndEventListener(v,this.onTransitionHide);c('CSS').addClass(v,o);}else this.finishHide();return false;};u.prototype.onTransitionHide=function(){'use strict';c('ReactTransitionEvents').removeEndEventListener(this.layer.getContentRoot(),this.onTransitionHide);this.finishHide();};u.prototype.onTransitionShow=function(){'use strict';var v=this.layer.getContentRoot();c('ReactTransitionEvents').removeEndEventListener(v,this.onTransitionShow);c('requestAnimationFrame')(function(){c('CSS').removeClass(v,p);});};u.prototype.finishHide=function(){'use strict';var v=this.layer.getContentRoot();c('CSS').addClass(v,'accessible_elem');if(q){c('CSS').removeClass(v,n);c('CSS').removeClass(v,o);c('CSS').removeClass(v,r);}this.layer.setInsertParent(this.layer.getCausalElement());this.layer.finishHide();};u.prototype.onKeyDown=function(event){'use strict';var v=event.keyCode;if(v===c('RTLKeys').ESC||v===c('RTLKeys').RETURN||v===c('RTLKeys').TAB){this.props.onLayerBlur&&this.props.onLayerBlur(event);var w=c('ReactDOM').findDOMNode(this.refs.root),x=c('TabbableElements').find(this.getContextualLayerParent()),y=null,z=[],aa=v===c('RTLKeys').TAB&&event.shiftKey;for(var ba=0;ba<x.length;ba++)if(x[ba].tabIndex>-1){if(w.compareDocumentPosition(x[ba])&4){y=x[ba];break;}if(aa)z.push(x[ba]);}if(z.length)y=z[z.length-1];if(y){y.focus();event.preventDefault();}}};u.prototype.getContextualLayerParent=function(){'use strict';return c('Parent').byClass(c('ReactDOM').findDOMNode(this.refs.root),'uiContextualLayerParent')||document.body;};u.prototype.renderLayer=function(){'use strict';if(!this.isInDocument())return;c('ReactMount').renderSubtreeIntoContainer(this,c('React').createElement('div',babelHelpers['extends']({},this.props,{className:"_1oxk",onKeyDown:this.onKeyDown}),this.props.children,c('React').createElement('div',{className:"_41nt",style:{height:this.props.height}})),this.layer.getContentRoot());this.layer.conditionShow(this.props.shown);};u.prototype.render=function(){'use strict';return (c('React').createElement('div',{className:"_2r6l accessible_elem",ref:'root'}));};u.propTypes={shown:m.bool};f.exports=u;},null);
__d('UFIReactionsMenuImpl.react',['cx','Event','Locale','RTLKeys','React','ReactDOM','SubscriptionsHandler','UFIConfig','UFIReactionTypes','UFIReactionsDialogLayerImpl.react','addFocusEvents','getVendorPrefixedName','joinClasses','shallowCompare'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=8,l=96,m=48,n=44,o=c('UFIReactionTypes').reactions,p=c('getVendorPrefixedName')('transform'),q=c('addFocusEvents')('span');i=babelHelpers.inherits(r,c('React').Component);j=i&&i.prototype;function r(s,t){'use strict';j.constructor.call(this);var u=s.supportedReactions.filter(function(w){return o[w];}),v=s.allowKeyboardFocus?Math.max(0,u.indexOf(s.initialReaction)):-1;this.state={hasKeyboardFocus:s.allowKeyboardFocus,selectedIndex:v,supportedReactions:u};this.focusSelected=this.focusSelected.bind(this);this.onDragStart=this.onDragStart.bind(this);this.onKeyDown=this.onKeyDown.bind(this);}r.prototype.componentWillReceiveProps=function(s){'use strict';if(!s.shown&&this.props.shown)this.setState({hasKeyboardFocus:s.allowKeyboardFocus,selectedIndex:-1});this.setState({supportedReactions:s.supportedReactions.filter(function(t){return o[t];})});};r.prototype.componentDidMount=function(){'use strict';if(this.props.allowKeyboardFocus)this.focusSelected();};r.prototype.componentDidUpdate=function(s,t){'use strict';if(this.props.allowKeyboardFocus&&!s.allowKeyboardFocus)this.focusSelected();if(this.props.isLongPressing&&!s.isLongPressing){var u,v=new (c('SubscriptionsHandler'))();v.addSubscriptions(c('Event').listen(document.documentElement,'touchmove',function(event){event.preventDefault();var w=event.touches[0],x=document.elementFromPoint(w.clientX,w.clientY),y=parseInt(x.getAttribute('data-reaction'),10)||null;if(y!==u){if(u)this.onReactionMouseLeave(u,event);if(y)this.onReactionMouseEnter(y,event);u=y;}}.bind(this)),c('Event').listen(document.documentElement,'touchend',function(event){if(u)this.onReactionClick(u,event);if(v){v.release();v=null;}}.bind(this)));}};r.prototype.focusSelected=function(){'use strict';var s=c('ReactDOM').findDOMNode(this.refs[this.state.selectedIndex]);if(s)s.focus();};r.prototype.shouldComponentUpdate=function(s,t){'use strict';return c('shallowCompare')(this,s,t);};r.prototype.onDragStart=function(event){'use strict';event.preventDefault();};r.prototype.onKeyboardFocus=function(s,event){'use strict';this.setState({hasKeyboardFocus:true,selectedIndex:s});this.props.onFocus&&this.props.onFocus(event);};r.prototype.onKeyDown=function(event){'use strict';switch(event.keyCode){case c('RTLKeys').RETURN:event.preventDefault();var s=this.state.supportedReactions[this.state.selectedIndex];this.props.onReactionClick&&this.props.onReactionClick(s,event);break;case c('RTLKeys').getLeft():case c('RTLKeys').getRight():event.preventDefault();this.setState({selectedIndex:Math.max(0,Math.min(this.state.selectedIndex+(event.keyCode===c('RTLKeys').getLeft()?-1:1),this.state.supportedReactions.length-1))},this.focusSelected);break;}};r.prototype.onReactionClick=function(s,event){'use strict';event.preventDefault();this.props.onReactionClick&&this.props.onReactionClick(s,event);};r.prototype.onReactionMouseEnter=function(s,event){'use strict';this.setState({selectedIndex:this.props.supportedReactions.indexOf(s)});this.props.onReactionMouseEnter&&this.props.onReactionMouseEnter(s);};r.prototype.onReactionMouseLeave=function(s,event){'use strict';this.setState({selectedIndex:-1});this.props.onReactionMouseLeave&&this.props.onReactionMouseLeave(s);};r.prototype.render=function(){'use strict';var s=this.state.supportedReactions.length,t=c('UFIConfig').reactionsHasMegaDock&&s>2,u=(s*m-l)/(s-1),v=this.state.selectedIndex,w=this.state.supportedReactions.map(function(x,y){var z=o[x].display_name,aa=this.onReactionClick.bind(this,x),ba=Math.max(0,this.state.supportedReactions.indexOf(this.props.initialReaction))===y,ca=null;if(t&&v!==-1){var da,ea=(v===y?l:u)/l,fa=0;if(y<v){fa=-(m-m*ea+(m-l*ea)*y);}else if(y>v){fa=(m-u)*(s/2-y);}else fa=-(m*y-u*y);if(c('Locale').isRTL())fa=-fa;ca=(da={},da[p]='translateX('+Math.floor(fa)+'px) scale('+ea+')',da);}var ga,ha=this.props.icon;if(ha){ga=c('React').createElement(ha,{animate:this.props.shown,maxSize:t?l:m,reaction:o[x].name});}else ga=c('React').createElement('i',{className:c('joinClasses')(c('UFIReactionTypes').reactions[x].class_name,"_iuz")});return (c('React').createElement(q,{'aria-pressed':this.props.initialReaction===x,'aria-label':z,className:"_iuw"+(v===y?' '+"_iuy":''),href:'#',key:'reaction_'+x,onClick:aa,onDragStart:this.onDragStart,onKeyboardFocus:this.onKeyboardFocus.bind(this,y),onMouseEnter:this.onReactionMouseEnter.bind(this,x),onMouseLeave:this.onReactionMouseLeave.bind(this,x),onTouchStart:this.onDragStart,onTouchEnd:aa,ref:y,role:'button',tabIndex:ba&&(!this.props.shown||v===y)?0:-1},c('React').createElement('div',{className:"_39m",'data-reaction':x},c('React').createElement('div',{className:"_39n",style:ca},ga,c('React').createElement('div',{className:"_d6l"},c('React').createElement('div',{className:"_4sm1"},z))))));}.bind(this));return (c('React').createElement(c('UFIReactionsDialogLayerImpl.react'),{height:(t?v!==-1?u:m:n)+k,onLayerBlur:this.props.onBlur,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,shown:this.props.shown},c('React').createElement('div',{className:"_iu-"+(this.state.hasKeyboardFocus?' '+"_5wkt":'')+(t?' '+"_17hc":''),onKeyDown:this.onKeyDown,ref:'root',role:'toolbar'},w)));};f.exports=r;},null);