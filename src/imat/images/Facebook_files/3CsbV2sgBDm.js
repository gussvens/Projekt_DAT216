/*!CK:1060021293!*//*1457384802,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["BdHGp"]); }

__d('FBRTCIncomingCallDialog',['AsyncDialog','AsyncRequest','BanzaiLogger','Dialog','setTimeoutAcrossTransitions','XIncomingCallDialogController','FBRTCSoundController','mixInEventEmitter'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=70000;function i(j,k){'use strict';this.peerID=j;this.callID=k;this.$FBRTCIncomingCallDialog1=null;}i.prototype.showIncomingDialog=function(j){'use strict';var k=c('Dialog').getCurrent();if(k)k.hide();var l=c('XIncomingCallDialogController').getURIBuilder().setInt('user_id',this.peerID).setInt('call_id',this.callID).setString('dialog_type',j).getURI();this.$FBRTCIncomingCallDialog1=new (c('AsyncRequest'))(l);c('AsyncDialog').send(this.$FBRTCIncomingCallDialog1,this.$FBRTCIncomingCallDialog2.bind(this));};i.prototype.$FBRTCIncomingCallDialog2=function(j){'use strict';if(!this.$FBRTCIncomingCallDialog1){setTimeout(function(){j.hide();},1);return;}this.$FBRTCIncomingCallDialog1=null;this.view=j;j.subscribe('confirm',this.$FBRTCIncomingCallDialog3.bind(this));j.subscribe('cancel',this.$FBRTCIncomingCallDialog4.bind(this));c('FBRTCSoundController').playIncomingRingtone(this.callID,this.peerID,true);this.timeout=c('setTimeoutAcrossTransitions')(this.$FBRTCIncomingCallDialog5.bind(this),h);};i.prototype.cancel=function(){'use strict';if(this.$FBRTCIncomingCallDialog1){this.$FBRTCIncomingCallDialog1.abort();this.$FBRTCIncomingCallDialog1=null;}if(this.timeout)clearTimeout(this.timeout);if(this.view){this.view.hide();this.view=null;}c('FBRTCSoundController').stopIncomingRingtone();};i.prototype.isForPeer=function(j){'use strict';return this.peerID===j;};i.prototype.isForCall=function(j){'use strict';return this.callID===j;};i.prototype.isForPeerAndCall=function(j,k){'use strict';return this.peerID===j&&this.callID===k;};i.prototype.$FBRTCIncomingCallDialog3=function(j,k){'use strict';this.cancel();c('BanzaiLogger').log('VideoCallLoggerConfig',{event:'accept_call_click'});this.emit('answerCall',k.value);};i.prototype.$FBRTCIncomingCallDialog4=function(){'use strict';this.cancel();this.emit('ignoreCall');};i.prototype.$FBRTCIncomingCallDialog5=function(){'use strict';this.cancel();this.emit('timeout');};c('mixInEventEmitter')(i,{answerCall:true,ignoreCall:true,timeout:true});f.exports=i;},null);