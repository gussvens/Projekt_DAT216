/*!CK:3835291796!*//*1457384220,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["9H2Hz"]); }

__d('FBRTCMissedVideoCallHandler',['Arbiter','AsyncDialog','AsyncRequest','ChannelConstants','FBRTCCore','FBRTCLogger','FBRTCSupport','XVideoCallMissedCallController','XVideoCallMissedCallDialogController'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=null,i=null,j=null;k.prototype.hideDialog=function(){'use strict';if(h){h.hide();h=null;i=null;if(j){j.unsubscribe();j=null;}}};function k(){'use strict';this.$FBRTCMissedVideoCallHandler1=null;}k.prototype.onCallMissed=function(l){'use strict';if(!c('FBRTCSupport').isWebrtcSupported())return;if(i===null)this.$FBRTCMissedVideoCallHandler1=l;};k.prototype.showDialog=function(){'use strict';if(!this.$FBRTCMissedVideoCallHandler1||i)return;i=this.$FBRTCMissedVideoCallHandler1;this.$FBRTCMissedVideoCallHandler1=null;var l=c('XVideoCallMissedCallController').getURIBuilder().setInt('user_id',i).getURI(),m=new (c('AsyncRequest'))(l);c('AsyncDialog').send(m,this.$FBRTCMissedVideoCallHandler2.bind(this));};k.prototype.$FBRTCMissedVideoCallHandler2=function(l){'use strict';h=l;l.subscribe('confirm',this.$FBRTCMissedVideoCallHandler3.bind(this));l.subscribe('cancel',this.$FBRTCMissedVideoCallHandler4.bind(this));j=c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('dismiss_all_missed_call_dialog'),this.$FBRTCMissedVideoCallHandler5.bind(this));};k.prototype.$FBRTCMissedVideoCallHandler3=function(){'use strict';c('FBRTCCore').startOutgoingCall(i,c('FBRTCLogger').Trigger.RETURN_CALL,false);this.$FBRTCMissedVideoCallHandler4();};k.prototype.$FBRTCMissedVideoCallHandler4=function(){'use strict';this.hideDialog();this.$FBRTCMissedVideoCallHandler6();};k.prototype.$FBRTCMissedVideoCallHandler6=function(){'use strict';new (c('AsyncRequest'))(c('XVideoCallMissedCallDialogController').getURIBuilder().getURI()).send();};k.prototype.$FBRTCMissedVideoCallHandler5=function(){'use strict';this.hideDialog();};f.exports=k;},null);